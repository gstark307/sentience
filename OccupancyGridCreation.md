Occupancy grids provide a method for convenient and reasonably efficient representation of space.  The classical method of grid formation is described in a [paper by Hans Moravec and Alberto Elfes](OccupancyGridReferences.md).  However, although these methods are able to model observational uncertainties they typically made no attempts to take into account uncertainty in the robot's pose as it moves through its environment.  Taking account of pose uncertainty effectively means building multiple occupancy grids in parallel, which could be extremely computationally expensive (especially for 3D grids).

However as chance would have it there are methods for containing this type of combinatorial explosion, such that the computation workload remains reasonable for real time operations.  The method presently used is an adapted version of the distributed particle SLAM (DP-SLAM) algorithm developed by [Austin Eliazar and Ronald Parr](OccupancyGridReferences.md).  The original DP-SLAM experiments used a scanning laser rangefinder as the main sensor, and involved little or no explicit sensor modeling.  This basic method was adapted to accept 3D data from a stereo diaparity map - turning disparities into probabilistic ray models which could then be inserted as occupancy hypotheses into the SLAM algorithm.  One key advantage of the DP-SLAM method is that it does not assume that any landmarks or distinctive features have been located.  In principle the entire disparity map can be shovelled indiscriminately into the grid.  However, in practice to maintain performance a random sample of disparities are used at any given time step.  This gives good coverage and allows dense occupancy grids to form, which may be useful both for navigation and object identification purposes.

The DP-SLAM method is basically a form of tree search applied to spatial observations.  At any point in time uncertainty in sensing and actuation mean that the same sequence of images could correspond to multiple possible paths through the environment.  Effectively the robot is traversing a multiverse, and it's only by accumulating sequences of observations and using them to create an occupancy grid that the most likely paths can be discovered.  A quasi-selectionist strategy is applied where hypothetical paths with lower spatial and colour consistency are pruned from the search tree, leaving the more consistent ones to continue growing.  Eventually all hypothetical paths collapse to a single possibility, and at this point hypothetical occupancies are _distilled_ to the grid.

In tests so far the DP-SLAM method works remarkably well, even in the presence of considerable pose uncertainties.  It looks like this is going to provide both a robust and scalable method for spatial perception.  Multiple hypothetical paths (branches of the tree) can be run in parallel within separate threads, so as more CPU cores become available the system can scale gracefully to achive maximum occupancy grid consistency.

Formation of an occupancy grid using the distributed particle SLAM method can be seen in the animation below.

![http://sentience.googlegroups.com/web/corridor_sequence1.gif](http://sentience.googlegroups.com/web/corridor_sequence1.gif)

The evolution of a set of hypothetical paths looks like this:

![http://sentience.googlegroups.com/web/dpslam_tree2.gif](http://sentience.googlegroups.com/web/dpslam_tree2.gif)